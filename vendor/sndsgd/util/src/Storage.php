<?php

namespace sndsgd;

/**
 * Storage for various values
 */
class Storage extends Singleton
{
    /**
     * Storage for values
     *
     * @var array<string,mixed>
     */
    private $values = [];

    /**
     * Get a value by calling its key as a static method
     *
     * @param string $name The name of the called method
     * @param array $args The arguments provided to the method
     * @return mixed
     */
    public static function __callStatic(string $name, array $args)
    {
        $instance = static::getInstance();
        return $instance->get($name);
    }

    /**
     * Import values
     *
     * @param array<string,mixed> $values
     */
    public function import(array $values)
    {
        $this->values = $values;
    }

    /**
     * Export the current values
     *
     * @return array<string,mixed>
     */
    public function export(): array
    {
        return $this->values;
    }

    /**
     * Add an object to the container
     *
     * @param string $name A key to used for retrieving the value later
     * @param mixed $value The value to add
     */
    public function set(string $name, $value)
    {
        $this->values[$name] = $value;
    }

    /**
     * Retrieve a value
     *
     * @param string $name
     * @return mixed
     * @throws \Exception If the provided name doesn't exist
     */
    public function get(string $name)
    {
        if (!array_key_exists($name, $this->values)) {
            throw new \Exception("no value exists for '$name'");
        }
        return $this->values[$name];
    }

    /**
     * Determine if a given name exists
     *
     * @param string $name
     * @return boolean
     */
    public function has($name)
    {
        return array_key_exists($name, $this->values);
    }
}
